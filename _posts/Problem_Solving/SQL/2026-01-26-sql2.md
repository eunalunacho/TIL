---
title: "[프로그래머스] : 주문량이 많은 아이스크림들 조회하기"
date: 2026-02-26 09:49:00 +0900  
categories: [SQL]                
tags: [TIL, ORACLE, MYSQL, 프로그래머스, 코딩테스트]       
permalink: /20260226_sql2/          
--- 

### 문제 링크

[문제 바로가기](https://school.programmers.co.kr/learn/courses/30/lessons/133027)



### 내 풀이
MYSQL
```sql
SELECT FLAVOR
FROM 
    (SELECT FLAVOR, TOTAL_ORDER
    FROM FIRST_HALF 
    UNION ALL
    SELECT FLAVOR, TOTAL_ORDER
    FROM JULY) SUB
GROUP BY FLAVOR
ORDER BY SUM(TOTAL_ORDER) DESC
LIMIT 3;
```

<br>

### 다른 풀이
```sql
SELECT FLAVOR
FROM (
    SELECT FLAVOR, TOTAL_ORDER 
    FROM FIRST_HALF
    
    UNION ALL
    
    SELECT FLAVOR, SUM(TOTAL_ORDER) AS TOTAL_ORDER
    FROM JULY
    GROUP BY FLAVOR
) SUB
GROUP BY FLAVOR
ORDER BY SUM(TOTAL_ORDER) DESC
LIMIT 3;
```

<br>

### 기록

- <UNION ALL>은 빠르지만 그 뒤에 오는 <GROUP BY>의 연산량이 기하급수적으로 늘음 
- <UNION ALL>의 결과물을 모두 메모리에 올려야해 디스크 스왑 발생 가능성이 높음 
- 합치고 나서 줄인다보다는, 줄이고 나서 합친다가 효율적 
