---
title: "[프로그래머스] : 식품분류별 가장 비싼 식품의 정보 조회하기"
date: 2026-02-26 11:43:00 +0900  
categories: [SQL]                
tags: [TIL, ORACLE, MYSQL, 프로그래머스, 코딩테스트]       
permalink: /20260226_sql4/          
--- 

### 문제 링크

[문제 바로가기](https://school.programmers.co.kr/learn/courses/30/lessons/131116)



### 내 풀이
MYSQL
```sql
WITH MAX_PRICE AS (
    SELECT CATEGORY, MAX(PRICE) AS MAX_PRICE
    FROM FOOD_PRODUCT 
    WHERE CATEGORY IN ('과자', '국', '김치', '식용유')
    GROUP BY CATEGORY
) 
SELECT F.CATEGORY, F.PRICE AS MAX_PRICE, F.PRODUCT_NAME
FROM FOOD_PRODUCT F
    INNER JOIN MAX_PRICE M ON F.CATEGORY = M.CATEGORY
WHERE F.PRICE = M.MAX_PRICE 
ORDER BY F.PRICE DESC;
```

<br>

### 다른 풀이
```sql
SELECT CATEGORY, PRICE AS MAX_PRICE, PRODUCT_NAME
FROM (
    SELECT PRODUCT_ID, PRODUCT_NAME, CATEGORY, PRICE,
           ROW_NUMBER() OVER (PARTITION BY CATEGORY ORDER BY PRICE DESC) AS RNK
    FROM FOOD_PRODUCT
    WHERE CATEGORY IN ('과자', '국', '김치', '식용유') -- 미리 필터링 (Predicate Pushdown)
) SUB
WHERE RNK = 1 -- 1등만 뽑기
ORDER BY PRICE DESC;
```

<br>

### 기록

- window function을 쓰면 테이블을 한 번만 스캔하면서 정렬과 필터링을 동시 수행할 수 있음 
- ROW_NUMBER()를 쓰면 동점자가 있어도 무조건 1명만 뽑음 
- (Category, Price Desc)를 인덱스로 설정하면 O(1)에 가깝게 조회 가능 (Loose Index Scan)