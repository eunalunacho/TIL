---
title: "[프로그래머스] : 저자 별 카테고리 별 매출액 집계하기"
date: 2026-01-26 15:30:00 +0900  
categories: [SQL]                
tags: [TIL, ORACLE, MYSQL, 프로그래머스, 코딩테스트]       
permalink: /20260126_sql6/          
--- 

### 문제 링크

[문제 바로가기](https://school.programmers.co.kr/learn/courses/30/lessons/144856)



### 내 풀이
MYSQL
```sql
SELECT B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY, 
    SUM(B.PRICE * S.SALES) AS TOTAL_SALES
FROM BOOK_SALES S
INNER JOIN BOOK B ON S.BOOK_ID = B.BOOK_ID
INNER JOIN AUTHOR A ON B.AUTHOR_ID = A.AUTHOR_ID
WHERE S.SALES_DATE BETWEEN '2022-01-01' AND '2022-01-31'
    AND S.BOOK_ID = B.BOOK_ID
    AND B.AUTHOR_ID = A.AUTHOR_ID
GROUP BY B.AUTHOR_ID, B.CATEGORY, A.AUTHOR_NAME
ORDER BY B.AUTHOR_ID ASC, B.CATEGORY DESC;
```

<br>

### 다른 풀이
```sql
SELECT 
    B.AUTHOR_ID, 
    A.AUTHOR_NAME, 
    B.CATEGORY, 
    SUM(PreAgg.TOTAL_QTY * B.PRICE) AS TOTAL_SALES
FROM (
    -- [1단계] 대용량 SALES 테이블을 먼저 '도서별'로 압축 (Row 수 획기적 감소)
    SELECT BOOK_ID, SUM(SALES) AS TOTAL_QTY
    FROM BOOK_SALES
    WHERE SALES_DATE BETWEEN '2022-01-01' AND '2022-01-31'
    GROUP BY BOOK_ID
) PreAgg
INNER JOIN BOOK B ON PreAgg.BOOK_ID = B.BOOK_ID -- [2단계] 압축된 데이터와 조인
INNER JOIN AUTHOR A ON B.AUTHOR_ID = A.AUTHOR_ID
GROUP BY B.AUTHOR_ID, A.AUTHOR_NAME, B.CATEGORY
ORDER BY B.AUTHOR_ID ASC, B.CATEGORY DESC;
```

<br>

### 기록

- inner join에 쓴 조건을 where문에 또 작성하는 건 중복 연산
- 집계 후 join 방식을 사용하는 게 효율적 