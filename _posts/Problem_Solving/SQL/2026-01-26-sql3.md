---
title: "[프로그래머스] : 특정 기간동안 대여 가능한 자동차들의 대여비용 구하기"
date: 2026-01-26 11:02:00 +0900  
categories: [SQL]                
tags: [TIL, ORACLE, MYSQL, 프로그래머스, 코딩테스트]       
permalink: /20260126_sql3/          
--- 

### 문제 링크

[문제 바로가기](https://school.programmers.co.kr/learn/courses/30/lessons/157339)



### 내 풀이
MYSQL
```sql
SELECT C.CAR_ID, C.CAR_TYPE, FLOOR(C.DAILY_FEE * 30 * (100 - D.DISCOUNT_RATE) / 100) AS FEE 
FROM CAR_RENTAL_COMPANY_CAR C
INNER JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN D 
        ON C.CAR_TYPE = D.CAR_TYPE
        AND D.DURATION_TYPE = '30일 이상'
WHERE C.CAR_TYPE IN ('세단', 'SUV')
    AND NOT EXISTS (
        SELECT 1
        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY H
        WHERE C.CAR_ID = H.CAR_ID
            AND START_DATE <= '2022-11-30' 
            AND END_DATE >= '2022-11-01'
    )
HAVING FEE >= 500000 AND FEE < 2000000
ORDER BY FEE DESC, CAR_TYPE ASC, CAR_ID DESC;
```

<br>

### 다른 풀이
```sql

```

<br>

### 기록

- 시간 내에 못 품
- LEFT JOIN 방식은 거대한 join 테이블을 메모리상에 생성한 뒤 필터링 (full scan 가능성 높음)
- NOT EXISTS 방식은 DB 엔진(Optimizer)이 겹치는 날짜가 단 하나라도 발견되면 즉시 탐색을 멈춤
- 데이터가 늘어날 때 병목을 막으려면 CAR_RENTAL_COMPANY_RENTAL_HISTORY 테이블에 CAR_ID, START_DATE, END_DATE를 기반으로 인덱스를 만드는 것이 좋음 