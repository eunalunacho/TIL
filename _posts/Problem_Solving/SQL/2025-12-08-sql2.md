---
title: "[solvesql] Advent of SQL 2025 : 8일차"
date: 2025-12-08 11:42:00 +0900  
categories: [SQL]                 
tags: [TIL, ORACLE, MYSQL, solvesql, 코딩테스트]       
permalink: /20251208_sql2/          
--- 

### 문제 링크

[문제 바로가기](https://solvesql.com/collections/advent-of-sql-2025/)



### 내 풀이
MYSQL
```sql
SELECT * 
FROM wines
WHERE color = 'white'
AND quality >= 7 
AND density >= (SELECT AVG(density) FROM wines) 
AND residual_sugar >  (SELECT AVG(residual_sugar) FROM wines) 
AND pH < (SELECT AVG(pH) FROM wines WHERE color = 'white') 
AND citric_acid >=  (SELECT AVG(citric_acid) FROM wines WHERE color = 'white'); 
```



### 다른 풀이
MYSQL
```sql
WITH AvgAll AS (
    SELECT 
        AVG(density) AS avg_density_all,
        AVG(residual_sugar) AS avg_residual_sugar_all
    FROM wines
),
AvgWhite AS (
    SELECT 
        AVG(pH) AS avg_pH_white,
        AVG(citric_acid) AS avg_citric_acid_white
    FROM wines
    WHERE color = 'white'
)
SELECT 
    w.* FROM 
    wines w
JOIN 
    AvgAll a_all ON 1=1  
JOIN      
    AvgWhite a_white ON 1=1  
WHERE 
    w.color = 'white'
    AND w.quality >= 7 
    AND w.density >= a_all.avg_density_all
    AND w.residual_sugar > a_all.avg_residual_sugar_all
    AND w.pH < a_white.avg_pH_white
    AND w.citric_acid >= a_white.avg_citric_acid_white;
```

### 코드 설명

기존에 작성한 코드는 테이블을 5번 불러 계산하고 또 한번 계산하는 코드.
WITH 함수로 각 조건 별로 평균값을 가지고 있는 테이블을 2번 만든 뒤, 
기존 테이블에 값을 붙여 WHERE로 구별 
