---
title: "[SQL] 프로그래머스 문제: 조건에 부합하는 사원 정보 조회하기"
date: 2025-10-13 00:21:00 +0900  
categories: [SQL]                 
tags: [TIL, ORACLE, MYSQL, 프로그래머스, 코딩테스트, 다시풀문제]       
permalink: /20251010_sql4/          
--- 

### 문제 링크

[문제 바로가기](https://school.programmers.co.kr/learn/courses/30/lessons/284527)



### **문제 설명**

HR_DEPARTMENT 테이블은 회사의 부서 정보를 담은 테이블입니다. HR_DEPARTMENT 테이블의 구조는 다음과 같으며 DEPT_ID, DEPT_NAME_KR, DEPT_NAME_EN, LOCATION은 각각 부서 ID, 국문 부서명, 영문 부서명, 부서 위치를 의미합니다.

HR_EMPLOYEES 테이블은 회사의 사원 정보를 담은 테이블입니다. HR_EMPLOYEES 테이블의 구조는 다음과 같으며 EMP_NO, EMP_NAME, DEPT_ID, POSITION, EMAIL, COMP_TEL, HIRE_DATE, SAL은 각각 사번, 성명, 부서 ID, 직책, 이메일, 전화번호, 입사일, 연봉을 의미합니다.

HR_GRADE 테이블은 2022년 사원의 평가 정보를 담은 테이블입니다. HR_GRADE의 구조는 다음과 같으며 EMP_NO, YEAR, HALF_YEAR, SCORE는 각각 사번, 연도, 반기, 평가 점수를 의미합니다.



---

### 문제

HR_DEPARTMENT, HR_EMPLOYEES, HR_GRADE 테이블에서 2022년도 한해 평가 점수가 가장 높은 사원 정보를 조회하려 합니다. 2022년도 평가 점수가 가장 높은 사원들의 점수, 사번, 성명, 직책, 이메일을 조회하는 SQL문을 작성해주세요.

2022년도의 평가 점수는 상,하반기 점수의 합을 의미하고, 평가 점수를 나타내는 컬럼의 이름은 SCORE로 해주세요.



---

### 예시




### 내 풀이
MYSQL
```sql
SELECT SUM(B.SCORE) AS SCORE, A.EMP_NO, A.EMP_NAME, A.POSITION, A.EMAIL
FROM HR_EMPLOYEES A, HR_GRADE B
WHERE A.EMP_NO = B.EMP_NO
    AND B.YEAR = '2022'
GROUP BY A.EMP_NO
HAVING SUM(B.SCORE) = (SELECT MAX(total)
                        FROM (SELECT SUM(SCORE) AS total
                                FROM HR_GRADE
                                WHERE YEAR = '2022'
                                GROUP BY EMP_NO
                        ) AS sub);
```



### 코드 설명

중첩된 집계 함수를 사용할 수 없음
WHERE문에서는 SUM()을 사용할 수 없음

WHERE은 GROUP BY 이전 조건, 집계 함수 사용 불가
HAVING은 GROUP BY 이후 조건, 집계 함수 사용 가능 



### 다른 풀이


