---
title: "[SQL] Advent of SQL 2025 : 9일차"
date: 2025-12-09 15:31:00 +0900  
categories: [SQL]                 
tags: [TIL, ORACLE, MYSQL, solvesql, 코딩테스트]       
permalink: /20251209_sql1/          
--- 

### 문제 링크

[문제 바로가기](https://solvesql.com/collections/advent-of-sql-2025/)



### 내 풀이
MYSQL
```sql
WITH
  kor_w_volleyball AS (
    SELECT
      r.athlete_id,
      a.name,
      g.year
      FROM records r
      JOIN athletes a ON r.athlete_id = a.id
      JOIN events e ON r.event_id = e.id
      JOIN games g ON r.game_id = g.id
      JOIN teams t ON r.team_id = t.id
    WHERE
      e.event = 'Volleyball Women''s Volleyball'
      AND t.team = 'KOR'
      AND g.year <= 2016
  ),
  game_joined AS (
    SELECT
      athlete_id,
      name,
      year,
      LAG(year, 1) OVER (
        PARTITION BY
          athlete_id
        ORDER BY
          year ASC
      ) AS prev_year
    FROM
      kor_w_volleyball
  )
SELECT DISTINCT
  athlete_id AS id,
  name
FROM
  game_joined
WHERE
  year - prev_year = 4;
```



### 다른 풀이



### 코드 설명

- WITH은 한번만 쓰고 콤마(,)로 구별, JOIN은 합칠 횟수만큼 여러번 작성 
- 중복을 제거하고 싶은 경우 SELECT DISTINCT 로 작성 

