---
title: "[SQL] Advent of SQL 2025 : 7일차"
date: 2025-12-08 09:29:00 +0900  
categories: [SQL]                 
tags: [TIL, ORACLE, MYSQL, solvesql, 코딩테스트]       
permalink: /20251208_sql1/          
--- 

### 문제 링크

[문제 바로가기](https://solvesql.com/collections/advent-of-sql-2025/)



### 내 풀이
MYSQL
```sql
WITH
  before_pm AS (
    SELECT
      measured_at,
      LAG(pm10, 2) OVER (
        ORDER BY measured_at ASC
      ) AS pm_day_before,
      LAG(pm10, 1) OVER (
        ORDER BY measured_at ASC
      ) AS pm_yesterday
    FROM
      measurements
    ORDER BY
      measured_at ASC
  )
SELECT
  m.measured_at AS date_alert
FROM
  measurements m
  JOIN before_pm b ON m.measured_at = b.measured_at
WHERE
  b.pm_yesterday - b.pm_day_before > 0
  AND m.pm10 - b.pm_yesterday > 0
  AND m.pm10 >= 30
ORDER BY
  m.measured_at ASC;
```



### 다른 풀이




### 코드 설명
MYSQL
```sql
LAG(변수, 시차) OVER (
        PARTITION BY 변수 
        ORDER BY 변수 ASC
      )
```
파티션 별로 나누어 sorting한 뒤, 설정한 시차 만큼의 값을 가져옴



